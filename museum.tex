
% A museum of no-longer-needed lemmas and such (fragments of proofs of which may however become useful later)

\begin{lemma}
 If for all $u \in \val{\tau_1}{\omega,\xi}{\Gamma}$ we have
 $t[\subst{x}{u}] \in \val{\tau_2}{\omega,\xi}{\Gamma}$, then
 $\lambda x : \omega(\tau_1) . t \in
 \val{\tau_1\to\tau_2}{\omega,\xi}{\Gamma}$.
\end{lemma}

\begin{proof}
 By Lemma~\ref{lem_val_computable} the
 sets~$\val{\tau_i}{\omega,\xi}{\Gamma}$ are candidates, so
 $\val{\tau_i}{\omega,\xi}{\Gamma} \subseteq \SN$. Let
 $u \in \val{\tau_1}{\omega,\xi}{\Gamma}$. We show
 $(\lambda x : \omega(\tau_1) . t) u \in
 \val{\tau_2}{\omega,\xi}{\Gamma}$ by induction on $\nu(t) +
 \nu(u)$. Suppose $(\lambda x : \omega(\tau_1) . t) u \leadsto
 w$. There are three cases.
 \begin{itemize}
 \item $w = t[\subst{x}{u}]$. Then
   $w \in \val{\tau_2}{\omega,\xi}{\Gamma}$ by assumption.
 \item $w = (\lambda x : \omega(\tau_1) . t') u$ with
   $t \leadsto t'$. Because $\val{\tau_2}{\omega,\xi}{\Gamma}$ is a
   candidate, still
   $t'[\subst{x}{u}] \in \val{\tau_2}{\omega,\xi}{\Gamma}$. Also
   $\nu(t') < \nu(t)$, so $w \in \val{\tau_2}{\omega,\xi}{\Gamma}$
   follows from the inductive hypothesis.
 \item $w = (\lambda x : \omega(\tau_1) . t) u'$ with
   $u \leadsto u'$. Because $\val{\tau_i}{\omega,\xi}{\Gamma}$ are
   candidates, still $u' \in \val{\tau_1}{\omega,\xi}{\Gamma}$ and
   $t[\subst{x}{u'}] \in \val{\tau_2}{\omega,\xi}{\Gamma}$. Also
   $\nu(u') < \nu(u)$, so $w \in \val{\tau_2}{\omega,\xi}{\Gamma}$
   follows from the inductive hypothesis.
 \end{itemize}
 Because $(\lambda x : \omega(\tau_1) . t) u$ is neutral and
 $\val{\tau_2}{\omega,\xi}{\Gamma}$ is a candidate, this shows
 $(\lambda x : \omega(\tau_1) . t) u \in
 \val{\tau_2}{\omega,\xi}{\Gamma}$.
\end{proof}

\begin{lemma}
 If for every type~$\tau$ and every $X \in \Cb_\tau^\Gamma$ we have
 $t \in
 \val{\sigma}{\omega[\subst{\alpha}{\tau}],\xi[\subst{\alpha}{X}]}{\Gamma}$,
 then
 $\Lambda \alpha . t \in
 \val{\forall\alpha[\sigma]}{\omega,\xi}{\Gamma}$.
\end{lemma}

\begin{proof}
 Let~$\tau$ be a type and $X \in \Cb_\tau^\Gamma$. By
 Lemma~\ref{lem_val_computable} the
 set~$\val{\forall\alpha[\sigma]}{\omega,\xi}{\Gamma}$ is a
 candidate, so $t \in \SN$. By induction on~$\nu(t)$ we show
 $(\Lambda \alpha . t) \alpha \in
 \val{\sigma}{\omega[\subst{\alpha}{\tau}],\xi[\subst{\alpha}{X}]}{\Gamma}$.
 Because~$\val{\sigma}{\omega[\subst{\alpha}{\tau}],\xi[\subst{\alpha}{X}]}{\Gamma}$
 is a candidate by Lemma~\ref{lem_val_computable}, it suffices to
 show that for every~$w$ with $(\Lambda \alpha . t) \leadsto w$ we
 have
 $w \in
 \val{\sigma}{\omega[\subst{\alpha}{\tau}],\xi[\subst{\alpha}{X}]}{\Gamma}$. There
 are two cases.
 \begin{itemize}
 \item $w = (\Lambda \alpha . t') \alpha$. Then $\nu(t') < \nu(t)$
   and
   $w \in
   \val{\sigma}{\omega[\subst{\alpha}{\tau}],\xi[\subst{\alpha}{X}]}{\Gamma}$
   follows from the inductive hypothesis.
 \item $w = t$. Then
   $w \in
   \val{\sigma}{\omega[\subst{\alpha}{\tau}],\xi[\subst{\alpha}{X}]}{\Gamma}$
   by assumption.
 \end{itemize}
\end{proof}
